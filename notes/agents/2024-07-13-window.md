# Agent Retrospective – 2024-07-13 (Admin core window guard)

- **Surprise:** `resolveScopeWindow` kept triggering a complexity warning because of the inline `if (!win)` guard—the ESLint rule counted the branch even though it was the only guard.
- **Action:** Introduced `ensureWindowAvailable` so `resolveScopeWindow` becomes a single call (the conditional is encapsulated in the helper), which keeps the exported resolver trivial while retaining the previous error handling.
- **Lesson:** Even simple guard blocks can push helper functions over tight complexity thresholds; wrapping them in named helpers keeps the entry point clean and the lint rule satisfied.
- **Follow-up idea:** Look for other helpers that still mix guard logic with the happy path and apply the same “guard helper” pattern where needed.
