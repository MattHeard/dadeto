# Log invalidate error guard

- **Unexpected**: the brief asked to drop the guard and remove tests around `logInvalidateError`, but the repo only exposes the helper in `src/core/cloud/generate-stats/generate-stats-core.js` and the generated `public` copy; no test files actually call `logInvalidateError` or assert behavior when `logger.error` is non-callable. I verified this with repo-wide grep before changing anything so I could truthfully explain why no tests were deleted.
- **Diagnosis & options**: after scanning `test/core/cloud/generate-stats/generate-stats-core.test.js` (and the rest of `test/` for `logInvalidateError`), the only logging coverage targets the end-to-end `invalidatePaths` flow, which always injects a working logger. That meant the only reasonable path was to enforce the new assumption and document that no tests needed removal, rather than inventing a nonexistent test to drop.
- **Learning**: when instructions mention removing coverage for a specific function, run a focused search (function name + synonyms) before touching tests so you can confidently report “none existed” instead of leaving reviewers guessing; this saves time and avoids rolling back phantom edits.
- **Additional note**: while eliminating the guard I trimmed the redundant `err !== null` check inside `getLogMessage` and then added explicit `else` returns so both the object branch and the fallback now return directly instead of relying on a trailing `return err`. That also motivated adding a new test that rejects with a primitive (`'boom'`) so we exercise the outer `else` and keep branch coverage green.
- **Follow-up idea**: should we codify “helpers assume `logger.error` is callable” somewhere (AGENTS, README, or a helper like `ensureLogger`) to prevent future agents from guarding in vain?
