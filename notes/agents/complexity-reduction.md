# Complexity Reduction Retrospective

- **Unexpected hurdle:** The complexity warnings ESLint reports for some of the cloud helpers (e.g., `resolveIncomingOptionContext` and `markVariantDirtyImpl`) do not disappear even after moving bits of logic into helpersâ€”the analyzer still counts optional chaining/guard clauses as branching, so reducing the score requires very targeted refactors.
- **What I learned:** Breaking logic into smaller helpers can reduce complexity for some functions (the `markVariantDirtyImpl`, `resolveVariantName`, and the header resolution helpers now register at complexity 3 or lower) but can also create fresh warnings when new helpers themselves exceed the threshold. Future agents should watch the `reports/lint/lint.txt` complexity list and adjust only a couple of helpers at a time, re-running `npm run lint` between each set of changes to keep the list manageable.
- **Open follow-ups:** Consider using helper factories that minimize optional chaining or restructure the offending functions so that their most complex logic lives in dedicated helpers (each with only a single guard, no `?.`/`??`). Additional remaining complexity-4 warnings in `src/core/cloud/render-contents` and `render-variant` still need attention; the list in `reports/lint/lint.txt` is the best source for choosing next candidates.
