## Reflection 2025-12-10

- Observed the new `minTokens` of 29 triggered clones in the policy-critical areas, so I factored the shared response builder, error helpers, and CORS helpers into dedicated modules; moving `createResponse`/`createCorsOriginHandler` usage also removed the clones without changing external behavior.
- Surfaced the missing `assertFunction` re-export from `cloud-core` when Jest demanded it; keeping the re-export alongside the internal import lets tests keep pulling from `cloud-core` while still importing from `common-core`.
- Learned that duplication detections may point to the same snippet across very different files, so I double-checked `jscpd` outputs rather than assuming the first file listed; rerunning the tool after each edit was useful to confirm the clone bucket emptied.

Open questions/follow-ups:
- Should we also locate other helpers (e.g., the Firebase-exception helpers in `src/cloud/common-gcf.js`) and rewire them to use `error-core.js` so the cloud folder stays consistent with the new shared layer?
